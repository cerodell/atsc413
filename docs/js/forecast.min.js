const sidebar=document.querySelector(".sidebar"),menu=document.querySelector(".menu-content"),menuItems=document.querySelectorAll(".submenu-item"),subMenuTitles=document.querySelectorAll(".submenu .menu-title");menuItems.forEach(((e,t)=>{e.addEventListener("click",(()=>{menu.classList.add("submenu-active"),e.classList.add("show-submenu"),menuItems.forEach(((e,a)=>{t!==a&&e.classList.remove("show-submenu")}))}))})),subMenuTitles.forEach((e=>{e.addEventListener("click",(()=>{menu.classList.remove("submenu-active")}))}));const slider=document.getElementById("mySlider");function sliderDateTime(e,t){var a=parseDateTime(t);return a.setHours(a.getHours()+3*e),formatDate(a)}function sliderModifier(e,t,a){var o=parseDateTime(e),l=(parseDateTime(t)-o)/108e5;slider.min=0,slider.max=l;l=(parseDateTime(a)-o)/108e5;slider.value=l}slider.addEventListener("input",(function(){var e=localStorage.getItem("loc"),t=localStorage.getItem("int"),a=localStorage.getItem("varname");showImage(e,t,sliderDateTime(slider.value,t),a)}));var menuItems_c=document.querySelectorAll(".menu-items a");menuItems_c.forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault(),localStorage.setItem("selectedMenuItem",e.getAttribute("href"))}))}));var selectedMenuItem=localStorage.getItem("selectedMenuItem");if(null!==selectedMenuItem){var selectedMenuItemLink=document.querySelector('.menu-items a[href="'+selectedMenuItem+'"]');selectedMenuItemLink&&selectedMenuItemLink.click()}function isDateInPast(e,t){return e.getTime()<t.getTime()}function parseDateTime(e){var t=parseInt(e.substr(0,4)),a=parseInt(e.substr(4,2)),o=parseInt(e.substr(6,2)),l=parseInt(e.substr(9,2));return new Date(t,a-1,o,l)}function formatDate(e){return e.getFullYear().toString()+(e.getMonth()+1).toString().padStart(2,"0")+e.getDate().toString().padStart(2,"0")+"Z"+e.getHours().toString().padStart(2,"0")}var loc=localStorage.getItem("loc"),int=localStorage.getItem("int"),valid=localStorage.getItem("valid"),dataI=localStorage.getItem("dataI"),dataJ=localStorage.getItem("dataJ"),varname=localStorage.getItem("varname");null===loc&&localStorage.setItem("loc","high_level"),null===int&&localStorage.setItem("int","20190516Z00"),null===valid&&localStorage.setItem("valid","20190516Z00"),null===dataI&&localStorage.setItem("dataI","20190516Z00"),null===dataJ&&localStorage.setItem("dataJ","20190520Z00"),null===varname&&localStorage.setItem("varname","50kPa"),console.log("loc:",loc),console.log("int:",int),console.log("valid:",valid),console.log("varname:",varname),showImage(loc,int,valid,varname);var buttonsContainer=document.getElementById(loc);buttonsContainer.classList.toggle("active");const buttons=document.querySelectorAll(".dropdown-option");function colorcase(e){e===localStorage.getItem("loc",loc)?console.log("KEEP COLOR"):(document.querySelectorAll(".button").forEach((t=>{t.id!==e&&t.classList.remove("active")})),document.getElementById(e).classList.add("active"))}function colortime(e){if(e===localStorage.getItem("int",int))console.log("KEEP COLOR FOR TIME");else{document.querySelectorAll(".dropdown-option").forEach((t=>{t.id!==e&&t.classList.remove("active")}));var t=document.getElementById(e);console.log(t),t.classList.add("active")}}function showImage(e,t,a,o){localStorage.setItem("int0",localStorage.getItem("int"));var l=localStorage.getItem("dataI"),n=localStorage.getItem("dataJ");if(console.log("================="),console.log("loc:",e),console.log("int:",t),console.log("valid:",a),console.log("varname:",o),console.log("dataI:",l),console.log("dataJ:",n),console.log(l==localStorage.getItem("int0")),console.log("================="),isDateInPast(parseDateTime(a),parseDateTime(l))&&l==localStorage.getItem("int0")){a=n;localStorage.setItem("valid",a),console.log("valid  less than dataI")}else if(isDateInPast(parseDateTime(n),parseDateTime(a))){a=t;localStorage.setItem("valid",a),console.log("dataJ  less than valid")}else if(isDateInPast(parseDateTime(a),parseDateTime(t))){a=t;localStorage.setItem("valid",a),console.log("valid less than int")}if(e===localStorage.getItem("loc",e))console.log("Same location"),sliderModifier(l,n,a);else{a=t;localStorage.setItem("valid",a),console.log("New location"),sliderModifier(l,n,a),imageUrl=`../img/${e}/gfs/${t}/${o}-${a.split("Z").join("")}.jpeg`,$.get(imageUrl).done((function(){})).fail((function(){localStorage.setItem("varname","50kPa")}))}sliderModifier(l,n,a),imageUrl=`../img/${e}/gfs/${t}/${o}-${a.split("Z").join("")}.jpeg`,$.get(imageUrl).done((function(){localStorage.setItem("loc",e),localStorage.setItem("int",t),localStorage.setItem("valid",a),localStorage.setItem("varname",o);document.getElementById("currentImage").src=imageUrl})).fail((function(){if(isDateInPast(parseDateTime(e),parseDateTime(t))){var e=t;localStorage.setItem("valid",e)}var a=localStorage.getItem("loc"),o=localStorage.getItem("varname");imageUrl=`../img/${a}/gfs/${t}/${o}-${e.split("Z").join("")}.jpeg`;document.getElementById("currentImage").src=imageUrl}))}function incrementDateTime(e){var t=parseDateTime(e);return t.setHours(t.getHours()+3),formatDate(t)}function decrementDateTime(e){var t=parseDateTime(e);return t.setHours(t.getHours()-3),formatDate(t)}buttons.forEach((function(e){e.addEventListener("click",(function(){const t=e.getAttribute("i"),a=e.getAttribute("j"),o=e.getAttribute("z");localStorage.setItem("dataI",t),localStorage.setItem("dataJ",a),localStorage.setItem("Z",o)})),e.addEventListener("dblclick",(function(){colorcase(e.getAttribute("loc")),colortime(e.getAttribute("i"))}))})),document.addEventListener("keydown",(function(e){var t=localStorage.getItem("loc"),a=localStorage.getItem("int"),o=localStorage.getItem("valid"),l=localStorage.getItem("varname");if("INPUT"!==e.target.tagName)if("ArrowLeft"===e.code)showImage(t,a,decrementDateTime(o),l);else if("ArrowRight"===e.code){showImage(t,a,incrementDateTime(o),l)}}));
